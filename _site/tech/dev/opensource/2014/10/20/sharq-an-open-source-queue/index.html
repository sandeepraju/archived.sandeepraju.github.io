<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">

    <title>SHARQ - an Open Source, Rate Limited, Queueing System - Sandeep Raju</title>

    <link rel="canonical" href="http://sandeepraju.in/tech/dev/opensource/2014/10/20/sharq-an-open-source-queue/">

    <!-- Bootstrap Core CSS -->
    <link rel="stylesheet" href="/css/bootstrap.min.css">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/clean-blog.css">

    <!-- Pygments Github CSS -->
    <link rel="stylesheet" href="/css/syntax.css">

    <!-- Custom Fonts -->
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link href='//fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
    <link href='//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css'>

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

</head>


<body>

    <!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">Sandeep Raju</a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="/">Home</a>
                </li>
                
                <li>
                    <a href="/about/">About</a>
                </li>
                
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container -->
</nav>


    <!-- Post Header -->
<header class="intro-header" style="background-image: url('/img/home-bg.jpg')">
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <div class="post-heading">
                    <h1>SHARQ - an Open Source, Rate Limited, Queueing System</h1>
                    
                    <span class="meta">Posted by Sandeep Raju on October 20, 2014</span>
                </div>
            </div>
        </div>
    </div>
</header>

<!-- Post Content -->
<article>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">

				<p>I have been fascinated about task queues since my college days. The way they are designed &amp; work has always interested me. Being a Pythonista, I have been using <a href="http://www.celeryproject.org/">Celery</a> for a long time. <a href="https://twitter.com/asksol">Ask</a> has done an amazing job building Celery and the ecosystem around it. It works great for general use-cases faced by a lot of companies in their day to day workflows (like sending out emails in the background, running periodic tasks, so on). However, sometimes that doesn’t suffice.</p>

<p>Recently, I faced an unique situation. I had to rate limit the queues in a specific system. Having used Celery for quite a few years, it was my natural choice. But soon, I realized that creating queues dynamically is not possible with Celery. Celery also lacked a clean way to <a href="http://celery.readthedocs.org/en/latest/userguide/tasks.html#Task.rate_limit">update the rate limit of a queue globally</a>. This was not acceptable for my use case.</p>

<p>All my efforts at searching for a queue with this specific feature set (dynamic queues, realtime rate limits &amp; constant flow rate) resulted in scripts and hacks written by several people, around various existing systems that were not built for this use case. It was apparent after some time that there was no simple, out of the box, cleaner solution for this problem and there was a scope for filling this void. This is how SHARQ came into existence.</p>

<p>SHARQ bridges this void in a simple and elegant manner by supporting all the above mentioned features. It is built using <a href="http://www.python.org/">Python</a> (<a href="http://flask.pocoo.org/">Flask</a> &amp; <a href="http://www.gevent.org/">Gevent</a> and uses <a href="http://redis.io/">Redis</a> as a broker. It talks HTTP with JSON payloads which makes writing workers in any language easy.</p>

<p>SHARQ can be installed from <a href="https://pypi.python.org/pypi">PyPI</a> using the following command:</p>

<div class="highlight"><pre><code class="language-bash" data-lang="bash">pip install sharq-server</code></pre></div>

<p>Once SHARQ is installed, it will expose a sharq-server command. The command is minimal and accepts a SHARQ configuration file. To get started quickly, grab the SHARQ <a href="https://raw.githubusercontent.com/plivo/sharq-server/master/sharq.conf">sample configuration file from here</a>. The SHARQ Server can be started with the following command:</p>

<div class="highlight"><pre><code class="language-bash" data-lang="bash">sharq-server --config sharq.conf</code></pre></div>

<p>and you’ll see SHARQ server running in foreground:</p>

<pre><code>___ _              ___    ___
/ __| |_  __ _ _ _ / _ \  / __| ___ _ ___ _____ _ _
\__ \ ' \/ _` | '_| (_) | \__ \/ -_) '_\ V / -_) '_|
|___/_||_\__,_|_|  \__\_\ |___/\___|_|  \_/\___|_|

Version: 0.1.0

Listening on: 127.0.0.1:8080
</code></pre>

<p>Now, you can play around with SHARQ using its <a href="http://sharq.io/docs/apireference.html">REST APIs</a>.To know more about how to use SHARQ and its enqueue-dequeue-finish workflow, checkout the <a href="http://sharq.io/docs/gettingstarted.html">getting started section on sharq.io</a>.</p>

<p>SHARQ is open source and is <a href="https://github.com/plivo/sharq-server">available on Github</a>. Pull requests are always welcome!</p>

<h2 id="further-reading">Further Reading</h2>

<ul>
  <li><a href="http://sharq.io/docs">The SHARQ docs</a>.</li>
  <li><a href="https://speakerdeck.com/sandeepraju/sharq-an-open-source-rate-limited-queueing-system-pycon-india-2014">SHARQ at PyCon India 2014</a>.</li>
  <li><a href="https://github.com/sandeepraju/PyCon-India-2014">SHARQ resources of the PyCon talk</a>.</li>
  <li>SHARQ example <a href="https://gist.github.com/sandeepraju/bfa72c7027e1d739b33e">Enqueue</a> and <a href="https://gist.github.com/sandeepraju/3da0ad035aa9bf5504b1">Dequeue</a> gists.</li>
  <li><a href="https://www.plivo.com/blog/sharq-a-flexible-open-source-rate-limited-queuing-system/">SHARQ on Plivo’s blog</a>.</li>
</ul>

<p><strong>NOTE</strong>: I am the primary author of SHARQ and will be maintaining it constantly with features and bug fixes. SHARQ was written at <a href="https://www.plivo.com">Plivo Inc</a>. All the views and opinions expressed in this article are my own and does in no way reflect that of Plivo or any other entity.</p>


                <hr>

                <ul class="pager">
                    
                    <li class="previous">
                        <a href="/dev/database/postgres/sql/2014/03/28/my-experiments-with-postgres/" data-toggle="tooltip" data-placement="top" title="My Experiments With Postgres">&larr; Previous Post</a>
                    </li>
                    
                    
                    <li class="next">
                        <a href="/life/etc/2015/09/27/it-has-been-an-year/" data-toggle="tooltip" data-placement="top" title="It has been an year already!">Next Post &rarr;</a>
                    </li>
                    
                </ul>
								
                <ul class="disqus">
										<div id="disqus_thread" aria-live="polite">
<script type="text/javascript">
      var disqus_shortname = 'SandeepRaju';
      
        
        var disqus_identifier = 'http://sandeepraju.in/tech/dev/opensource/2014/10/20/sharq-an-open-source-queue/';
        var disqus_url = 'http://sandeepraju.in/tech/dev/opensource/2014/10/20/sharq-an-open-source-queue/';
        var disqus_script = 'embed.js';
      
			(function () {
			  var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
			  dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
			  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
			}());
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

</div>
                </ul>
                

            </div>
        </div>
    </div>
</article>

<hr>


    <!-- Footer -->
<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="list-inline text-center">
                    <li>
                        <a href="/feed.xml">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-rss fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    <li>
                        <a href="https://twitter.com/sandeeprajup">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-twitter fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <li>
                        <a href="https://www.facebook.com/sandeep.raju.p">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-facebook fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <li>
                        <a href="https://github.com/sandeepraju">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                </ul>
                <p class="copyright text-muted">Copyright &copy; Sandeep Raju 2015</p>
            </div>
        </div>
    </div>
</footer>

<!-- jQuery -->
<script src="/js/jquery.min.js "></script>

<!-- Bootstrap Core JavaScript -->
<script src="/js/bootstrap.min.js "></script>

<!-- Custom Theme JavaScript -->
<script src="/js/clean-blog.min.js "></script>


</body>

</html>
